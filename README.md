# Анализ открытых финансовых данных для оптимизации направления инвестиций

## Описание проекта 
Данный проект посвящен практической реализации моделей <strong>линейной регрессии, RandomForestRegressor, GradientBoostingRegressor, SVR, KneighborsRegressor, CatBoostRegressor </strong> на языке программирования Python и сравнению эффективности данных моделей.  
<p> Для того, чтобы выяснить оптимальное количество прогнозируемых часов для каждой из моделей было проанализировано изменение коэффициента детерминации.</p>
В ходе проекта была проанализирована работа моделей на открытых финансовых данных валюты EURO за период с 01.10.2022 по 13.10.2022 год.  
Для более точного изучения и сравнения моделей подавались исходные данные в разных процентных соотношениях «обучение – прогноз»

## Цель проекта
Цель настоящей работы составляет <strong> изучение и освоение методов машинного обучения, анализ и сравнение эффективности существующих моделей прогнозирования и нейронной сети на открытых финансовых данных, 
а также рабочего веб-скрипта для их прогнозирования. </strong>

## Цель прогнозов
  Поскольку прогнозирование временных рядов, таких как продажи и спрос, часто имеет невероятную коммерческую ценность, это увеличивает потребность в прогнозировании. <br>
  <p> Прогнозы обычно используются во многих производственных компаниях, поскольку оно управляет первичным бизнес-планированием, закупками и производственной деятельностью.  
  Любые ошибки прогнозов будут проявляться по всей цепочке поставок или любой бизнес-структуре в этом отношении.</p>
	Таким образом, это важно для получения точных прогнозов, позволяющих сэкономить на затратах, и критически важно для успеха.

	Прогнозирование временных рядов можно в общих чертах разделить на две категории:

1.	Одномерное прогнозирование временных рядов. Это прогнозирование, в котором мы используем прежние значения временного ряда только для того, чтобы угадать предстоящие значения.
2.	Прогнозирование многовариантных временных рядов. Это прогнозирование временных рядов, в котором мы используем для прогнозиро-вания предикторы, отличные от ряда, также известные как экзогенные переменные.

## Сравнение методов машинного обучения с помощью языка Python. 

### Исходные данные
Для сравнительного анализа, рассмотрим работу методов на статистических данных об изменении цен валюты EURO за каждый час. 
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/1.png" />
</p>

### Реализация методов на языке Python.
На вход модели подадим данные об изменении цен валюты EURO за период с 01.10.2022 по 13.10.2022 год в соотношении 80 % модель получает на обучение, 20% прогнозирует сама.  
Результаты работы методов машинного обучения выведены на графики ниже.  
<p>Prediction(цена) (линия оранжевого цвета) на графике показывает результаты работы обучающей модели, линия цены (голубой цвет) выводит данные, полученные моделью на вход.</p>

 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/2.png" />
</p>
График 1. Прогнозирование цены валюты EURO методом линейной регрессии! 
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/3.png" />
</p>
График 2. Прогнозирование цены валюты EURO методом RandomForestRegressor.
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/4.png" />
</p>
График 3.  Прогнозирование цены валюты EURO методом GradientBoostingRegressor.
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/5.png" />
</p>
График 4. Прогнозирование цены валюты EURO методом SVR.
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/6.png" />
</p>
График 5. Прогнозирование цены валюты EURO методом KneighborsRegressor.

<p><br> При анализе полученных графиков, мы можем сделать вывод, что из-за прогнозирования большого промежутка времени коэффициент детерминации низкий,
а часто даже отрицательный.  
  Для того, чтобы прогноз был более точный мы значительно снизили количество прогнозируемых дней и провели анализ оптимального количества прогнозируемых дней для каждого из методов. </p>

### Сравнительный анализ методов машинного обучения
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/7.png" />
</p>
График. Зависимость коэффициента детерминации от количества прогнозируемых часов

<p><br> Исходя из результатов, показанных на графике, можно сделать вывод, что методы Random Forest и Gradient Boosting очень близки, 
по своим прогнозам, но все-таки Gradient Boosting показал чуть более точные результаты, так как Random Forest при прогнозировании более чем на 20 часов резко теряет в точности. 
У линейной регрессии результаты коэффициента детерминации падают ниже оптимального при прогнозировании более 10 часов. 
SVR и KNN показывают близкие результаты, но SVR является оп-тимальным на 2 часа дольше.</p>

### Сравнение способов прогнозирования с помощью языка Python.

#### Исходные данные
Для сравнительного анализа, рассмотрим работу наших методов на статистических данных об изменении цен валюты EURO за каждую минуту.  
На вход модели подадим данные об изменении цен валюты EURO за период с 27.11.2022 по 29.11.2022 год.  
Результаты работы методов машинного обучения выведены на графиках 7- Prediction(цена) (линия оранжевого цвета) на графике показывает результаты работы обучающей модели, 
линия цены (голубой цвет) выводит данные, полученные моделью на вход

<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/8.png" />
</p>
 MAE = 0,185<br>
График 7. Прогнозирование цены валюты EURO методом линейной регрессии, поми-нутно на час.

 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/9.png" />
</p>
 R2 = 0,695 MAE = 0,14 <br>
График 8. Прогнозирование цены валюты EURO методом линейной регрессии на час.

 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/10.png" />
</p>
 MAE = 0,152<br>
График 9. Прогнозирование цены валюты EURO методом RandomForestRegressor, по-минутно на час.

 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/11.png" />
</p>
 R2 = 0,809 MAE = 0,096<br>
График 10. Прогнозирование цены валюты EURO методом RandomForestRegressor, на час
 
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/12.png" />
</p>
 MAE = 0,164<br>
График 11. Прогнозирование цены валюты EURO методом GradientBoostingRegressor поминутно на час.


 
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/13.png" />
</p>
 R2 = 0,814 MAE = 0,0926 <br>
График 12. Прогнозирование цены валюты EURO методом GradientBoostingRegressor, на час.

 
 <p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/14.png" />
</p>
 
 MAE = 0,074 <br>
График 13. Прогнозирование цены валюты EURO методом SVR поминутно на час.


 
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/15.png" />
</p>
 R2 = 0,753 MAE = 0,117 <br>
График 14. Прогнозирование цены валюты EURO методом SVR, на час.

 
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/16.png" />
</p>

MAE = 0,134 <br>
График 15. Прогнозирование цены валюты EURO методом KneighborsRegressor поми-нутно на час.


 
<p align="center">
  <img src="https://github.com/ElenKor/Analytics/blob/main/images/17.png" />
</p>
R2 = 0,787 MAE = 0,105 <br>
График 16. Прогнозирование цены валюты EURO методом KneighborsRegressor, на час.



<p> <strong><br> При анализе полученных графиков, мы можем сделать вывод, 
что при прогнозировании статистических данных на час поминутно сильно падает точность прогноза в сравнении с прогнозом сразу на час. </strong></p>



